7a1575a497ad53248a671753c32dd36f
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PlanetService = void 0;
const mapToPlanet_1 = require("./service-mappers/mapToPlanet");
class PlanetService {
    constructor(swapiAdapter, planetRepository) {
        this.swapiAdapter = swapiAdapter;
        this.planetRepository = planetRepository;
    }
    async getPlanetById(id) {
        const planetData = await this.swapiAdapter.getPlanet(id);
        const planetStatus = await this.planetRepository.getPlanetDestructionStatus(id);
        // If planet is not in the database, consider it not destroyed
        const destroyed = planetStatus !== null ? planetStatus : false;
        return (0, mapToPlanet_1.mapToPlanet)(planetData, destroyed);
    }
    async upsertPlanetDestructionStatus(id, destroyed) {
        await this.planetRepository.upsertPlanetDestructionStatus(id, destroyed);
        return this.getPlanetById(id);
    }
}
exports.PlanetService = PlanetService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL3RtcC9zcmMvc2VydmljZXMvcGxhbmV0LnNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7O0FBRUEsK0RBQTREO0FBRzVELE1BQWEsYUFBYTtJQUl4QixZQUFZLFlBQTBCLEVBQUUsZ0JBQWtDO1FBQ3hFLElBQUksQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQztJQUMzQyxDQUFDO0lBRUQsS0FBSyxDQUFDLGFBQWEsQ0FBQyxFQUFVO1FBQzVCLE1BQU0sVUFBVSxHQUFHLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDekQsTUFBTSxZQUFZLEdBQUcsTUFBTSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsMEJBQTBCLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFaEYsOERBQThEO1FBQzlELE1BQU0sU0FBUyxHQUFHLFlBQVksS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBRS9ELE9BQU8sSUFBQSx5QkFBVyxFQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBRUQsS0FBSyxDQUFDLDZCQUE2QixDQUFDLEVBQVUsRUFBRSxTQUFrQjtRQUNoRSxNQUFNLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyw2QkFBNkIsQ0FBQyxFQUFFLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFFekUsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ2hDLENBQUM7Q0FDRjtBQXhCRCxzQ0F3QkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL3RtcC9zcmMvc2VydmljZXMvcGxhbmV0LnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3dhcGlBZGFwdGVyIH0gZnJvbSAnLi4vYWRhcHRlcnMvc3dhcGkuYWRhcHRlcic7XG5pbXBvcnQgeyBQbGFuZXQgfSBmcm9tICcuLi90eXBlcy9lbnRpdGllcy50eXBlcyc7XG5pbXBvcnQgeyBtYXBUb1BsYW5ldCB9IGZyb20gJy4vc2VydmljZS1tYXBwZXJzL21hcFRvUGxhbmV0JztcbmltcG9ydCB7IFBsYW5ldFJlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMvcGxhbmV0LnJlcG9zaXRvcnknO1xuXG5leHBvcnQgY2xhc3MgUGxhbmV0U2VydmljZSB7XG4gIHByaXZhdGUgc3dhcGlBZGFwdGVyOiBTd2FwaUFkYXB0ZXI7XG4gIHByaXZhdGUgcGxhbmV0UmVwb3NpdG9yeTogUGxhbmV0UmVwb3NpdG9yeTtcblxuICBjb25zdHJ1Y3Rvcihzd2FwaUFkYXB0ZXI6IFN3YXBpQWRhcHRlciwgcGxhbmV0UmVwb3NpdG9yeTogUGxhbmV0UmVwb3NpdG9yeSkge1xuICAgIHRoaXMuc3dhcGlBZGFwdGVyID0gc3dhcGlBZGFwdGVyO1xuICAgIHRoaXMucGxhbmV0UmVwb3NpdG9yeSA9IHBsYW5ldFJlcG9zaXRvcnk7XG4gIH1cblxuICBhc3luYyBnZXRQbGFuZXRCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFBsYW5ldD4ge1xuICAgIGNvbnN0IHBsYW5ldERhdGEgPSBhd2FpdCB0aGlzLnN3YXBpQWRhcHRlci5nZXRQbGFuZXQoaWQpO1xuICAgIGNvbnN0IHBsYW5ldFN0YXR1cyA9IGF3YWl0IHRoaXMucGxhbmV0UmVwb3NpdG9yeS5nZXRQbGFuZXREZXN0cnVjdGlvblN0YXR1cyhpZCk7XG5cbiAgICAvLyBJZiBwbGFuZXQgaXMgbm90IGluIHRoZSBkYXRhYmFzZSwgY29uc2lkZXIgaXQgbm90IGRlc3Ryb3llZFxuICAgIGNvbnN0IGRlc3Ryb3llZCA9IHBsYW5ldFN0YXR1cyAhPT0gbnVsbCA/IHBsYW5ldFN0YXR1cyA6IGZhbHNlO1xuXG4gICAgcmV0dXJuIG1hcFRvUGxhbmV0KHBsYW5ldERhdGEsIGRlc3Ryb3llZCk7XG4gIH1cblxuICBhc3luYyB1cHNlcnRQbGFuZXREZXN0cnVjdGlvblN0YXR1cyhpZDogc3RyaW5nLCBkZXN0cm95ZWQ6IGJvb2xlYW4pOiBQcm9taXNlPFBsYW5ldD4ge1xuICAgIGF3YWl0IHRoaXMucGxhbmV0UmVwb3NpdG9yeS51cHNlcnRQbGFuZXREZXN0cnVjdGlvblN0YXR1cyhpZCwgZGVzdHJveWVkKTtcblxuICAgIHJldHVybiB0aGlzLmdldFBsYW5ldEJ5SWQoaWQpO1xuICB9XG59Il0sInZlcnNpb24iOjN9